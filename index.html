<!-- File: index.html -->
<!-- License: MIT — https://github.com/AllieBaig/WordAtlas/blob/main/LICENSE -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0055aa" />
  <title>WordAtlas</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="icon" href="icons/icon-192.png" />
</head>

<body>
  <div class="fallback-banner" style="display:none;">
    🛟 <strong>Site1 Backup Active</strong>
  </div>

  <header>
    <h1>WordAtlas</h1>
    <p>Select a mode to begin</p>
  </header>

  <main id="menu" class="active">
    <section class="mode-buttons">
      <button class="menu-btn" data-mode="regular">🧠 Solo Mode</button>
      <button class="menu-btn" data-mode="wordRelic">🏺 Word Relic</button>
      <button class="menu-btn" data-mode="wordSafari">🦁 Word Safari</button>
      <button class="menu-btn" data-mode="dice">🎲 Dice Challenge</button>
      <button class="menu-btn" data-mode="atlas">🗺️ Word Atlas</button>
      <button class="menu-btn" data-mode="trail">🪄 Trail of Letters</button>
      <button class="menu-btn" data-mode="versus">🤖 Play vs Computer</button>
      <button class="menu-btn" data-mode="nearby">📍 Play Nearby</button>
    </section>
  </main>

  <section id="game" class="game-container"></section>

  <footer style="text-align:center; font-size:0.85rem; margin-top:2rem;">
    <a href="scripts/utils/error-log.html" target="_blank">🐞 View Error Log</a>
  </footer>

  <!-- Load main and nav scripts with fallback logic -->
  <script type="module">
    const primary = './scripts/';
    const fallback = './Site1/scripts/';
    const useBackup = localStorage.getItem('wordatlas-use-site1') === 'true';

    async function loadSafe(file) {
      const primaryPath = primary + file;
      const fallbackPath = fallback + file;

      try {
        await import(useBackup ? fallbackPath : primaryPath);
        console.log(`✅ Loaded ${file}`);
      } catch (err1) {
        try {
          document.body.classList.add('fallback-active');
          document.querySelector('.fallback-banner').style.display = 'block';
          await import(fallbackPath);
          console.warn(`⚠️ Fallback loaded: ${file}`);
        } catch (err2) {
          console.error(`❌ Failed to load: ${file}`, err2);
        }
      }
    }

    loadSafe('main.js');
    loadSafe('gameNavigation.js');
  </script>

  <script src="scripts/serviceWorkerRegistration.js"></script>
</body>
</html>
