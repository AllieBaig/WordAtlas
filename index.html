<!-- File: index.html -->
<!-- License: MIT — https://github.com/AllieBaig/WordAtlas/blob/main/LICENSE -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0055aa" />
  <title>WordAtlas</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="icon" href="icons/icon-192.png" />
</head>

<body>
  <div class="fallback-banner" style="display:none;">
    🛟 <strong>Site1 Backup Active</strong>
  </div>

  <header>
    <h1>WordAtlas</h1>
    <p>Select a mode to begin</p>
  </header>

  <main id="menu" class="active">
    <section class="mode-buttons">
      <button class="menu-btn" data-mode="regular">🧠 Solo Mode</button>
      <button class="menu-btn" data-mode="wordRelic">🏺 Word Relic</button>
      <button class="menu-btn" data-mode="wordSafari">🦁 Word Safari</button>
      <button class="menu-btn" data-mode="dice">🎲 Dice Challenge</button>
      <button class="menu-btn" data-mode="atlas">🗺️ Word Atlas</button>
      <button class="menu-btn" data-mode="trail">🪄 Trail of Letters</button>
      <button class="menu-btn" data-mode="versus">🤖 Play vs Computer</button>
      <button class="menu-btn" data-mode="nearby">📍 Play Nearby</button>
    </section>
  </main>

  <section id="game" class="game-container"></section>

  <footer style="text-align:center; font-size:0.85rem; margin-top:2rem;">
    <a href="scripts/utils/error-log.html" target="_blank">🐞 View Error Log</a>
    <details id="debugLinks" style="display:none;">
      <summary>🧪 Dev Tools</summary>
      <p>
        <a href="index.html">Main</a> |
        <a href="index-original">Original</a> |
        <a href="index-backup">Backup</a>
      </p>
    </details>
  </footer>

  <!-- Toast Notification -->
  <div id="toast" style="display:none;"></div>

  <!-- Load fallback-aware scripts -->
  <script type="module">
    const fallback = './Site1/scripts/';
    const primary = './scripts/';
    const forceSite1 = localStorage.getItem('wordatlas-use-site1') === 'true';

    async function loadScript(file) {
      const from = forceSite1 ? fallback : primary;
      try {
        await import(from + file);
        console.log(`✅ Loaded ${file} from ${from}`);
      } catch (err) {
        if (!forceSite1) {
          try {
            await import(fallback + file);
            document.body.classList.add('fallback-active');
            document.querySelector('.fallback-banner').style.display = 'block';
            console.warn(`⚠️ Fallback loaded: ${file}`);
          } catch (e) {
            console.error(`❌ Failed: ${file} from both paths`, e);
          }
        }
      }
    }

    loadScript('main.js');
    loadScript('gameNavigation.js');
  </script>

  <script src="scripts/serviceWorkerRegistration.js"></script>
</body>
</html>

